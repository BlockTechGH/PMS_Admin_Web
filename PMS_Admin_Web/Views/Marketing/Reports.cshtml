@{
    ViewData["Title"] = "Reports";
    //Layout = "_Layout1";
}

@using Microsoft.AspNetCore.Http;

<style>
    .button2:hover {
        box-shadow: 0 12px 16px 0 rgba(0,0,0,0.24),0 17px 50px 0 rgba(0,0,0,0.19);
    }
</style>

@if (ViewBag.Message != null)
{
    <script type="text/javascript">
        window.onload = function () {
            alert("@ViewBag.Message");
        };
    </script>

}

@if (ViewBag.Message == "Access denied")
{
    <script>
        history.back();
    </script>
}

<div class="container">
    <div class="row">
        <div class="col-lg-12">
            @*<div class="card" style="color:burlywood">*@
            @*<div class="card-header bg-transparent"></div>*@
            <div class="col-lg-12">
                <form>
                    @*<div class="card-body">*@
                    <br />
                    <br />
                    <div class="row">
                        <div class="col-lg-3">
                            <button id="btnSalesreport" type="button" class="btn btn-primary button2" data-target="#ReportParametersModal" data-toggle="modal" data-backdrop="static" style="width: 250px; height: 105px; border-radius: 12px; background-color: #e27d60;">
                                <div>
                                    <div>
                                        <i class="fa fa-align-justify" style="font-size:24px"></i>
                                    </div>
                                    <div>
                                        <strong>Sales Report</strong>
                                    </div>
                                </div>
                            </button>
                        </div>
                        <div class="col-lg-3">
                            <button id="btnMonthlyreport" type="button" class="btn btn-primary button2" data-target="#MonthlyReportModal" data-toggle="modal" data-backdrop="static" style="width: 250px; height: 105px; border-radius: 12px; background-color: palevioletred;">
                                <div>
                                    <div>
                                        <i class="fa-solid fa-file-contract" style="font-size:24px"></i>
                                    </div>
                                    <div>
                                        <strong>Monthly Report</strong>
                                    </div>
                                </div>
                            </button>
                        </div>
                        <div class="col-lg-3">
                            <button id="btnAllEnquiries" type="button" class="btn btn-primary button2" data-target="#AllEnquiriesModal" data-toggle="modal" data-backdrop="static" style="width: 250px; height: 105px; border-radius: 12px; background-color: #E8A87C ">
                                <div>
                                    <div>
                                        <i class="fa-solid fa-house" style="font-size:24px"></i>
                                    </div>
                                    <div>
                                        <strong>All Enquiries</strong>
                                    </div>
                                </div>
                            </button>
                        </div>
                        <div class="col-lg-3">
                            <button id="btnOpenEnquiries" type="button" class="btn btn-primary button2" data-target="#OpenEnquiriesModal" data-toggle="modal" data-backdrop="static" style="width: 250px; height: 105px; border-radius: 12px; background-color: #C38D9E ">
                                <div>
                                    <div>
                                        <i class="fa fa-search" style="font-size:24px"></i>
                                    </div>
                                    <div>
                                        <strong>Open Enquiries</strong>
                                    </div>
                                </div>
                            </button>
                        </div>
                    </div>
                    <br />
                    <div class="row">
                        <div class="col-lg-3">
                            <button id="btnCancelledEnquiries" type="button" class="btn btn-primary button2" data-target="#CancelledEnquiriesModal" data-toggle="modal" data-backdrop="static" style="width: 250px; height: 105px; border-radius: 12px; background-color: #41B3A3 ">
                                <div>
                                    <div>
                                        <i class="fa fa-search" style="font-size:24px"></i>
                                    </div>
                                    <div>
                                        <strong>Cancelled Enquiries</strong>
                                    </div>
                                </div>
                            </button>
                        </div>
                        <div class="col-lg-3">
                            <button id="btnDriverLogs" type="button" class="btn btn-primary button2" data-target="#DriverLogsModal" data-toggle="modal" data-backdrop="static" style="width: 250px; height: 105px; border-radius: 12px; background-color: #E7717D ">
                                <div>
                                    <div>
                                        <i class="fa fa-money" style="font-size:24px"></i>
                                    </div>
                                    <div>
                                        <strong>Driver Logs</strong>
                                    </div>
                                </div>
                            </button>
                        </div>
                        <div class="col-lg-3">
                            <button id="btnSourceProgress" type="button" class="btn btn-primary button2" data-target="#SourceProgressModal" data-toggle="modal" data-backdrop="static" style="width: 250px; height: 105px; border-radius: 12px; background-color: #9A1750 ">
                                <div>
                                    <div>
                                        <i class="fas fa-file-invoice-dollar" style="font-size:24px"></i>
                                    </div>
                                    <div>
                                        <strong>Source Progress</strong>
                                    </div>
                                </div>
                            </button>
                        </div>

                    </div>
                    <br />


                    @*</div>*@
                </form>
            </div>
            @*</div>*@
        </div>
    </div>

    <!--popup for ReportParameters-->
    <div id="ReportParametersModal" class="modal" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-lg" role="document">

            <div class="card" style="width: 350px; margin-left: 200px; ">
                <div class="card-body">
                    <form>
                        <div class="modal-content">

                            <div class="modal-header">
                                <h5 class="modal-title">Sales Detail</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <div class="form-group">
                                    <label style="color:black">From Date</label>
                                    <input id="fromdate1" type="date" class="form-control" style="border-radius: 10px;"/>
                                </div>
                                <div class="form-group">
                                    <label style="color:black">To Date</label>
                                    <input id="todate1" type="date" class="form-control" style="border-radius: 10px;" />
                                </div>
                                <div class="row">
                                    <div class="col-lg-12">
                                        <button id="btnPaid" type="button" class="btn btn-primary" style="border-radius:10px;">Paid</button>
                                        <button id="btnExpected" type="button" class="btn btn-primary" style="border-radius:10px;">Expected</button>
                                        <input type="hidden" id="Paidvalue" />
                                        <input type="hidden" id="Expectedvalue" />
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button id="btnPrint1" type="button" class="btn btn-primary" style="border-radius:10px;">Print</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <!---->
    <!--popup for MonthlyReport-->
    <div id="MonthlyReportModal" class="modal" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-lg" role="document">

            <div class="card" style="width: 350px; margin-left: 200px; ">
                <div class="card-body">
                    <form>
                        <div class="modal-content">

                            <div class="modal-header">
                                <h5 class="modal-title">Monthly Report</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <div class="form-group">
                                    <label style="color:black">From Date</label>
                                    <input id="fromdate2" type="date" class="form-control" style="border-radius: 10px;" />
                                </div>
                                <div class="form-group">
                                    <label style="color:black">To Date</label>
                                    <input id="todate2" type="date" class="form-control" style="border-radius: 10px;" />
                                </div>
                                
                            </div>
                            <div class="modal-footer">
                                <button id="btnPrint2" type="button" class="btn btn-primary" style="border-radius:10px;">Print</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <!---->
    <!--popup for AllEnquiries-->
    <div id="AllEnquiriesModal" class="modal" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-lg" role="document">

            <div class="card" style="width: 350px; margin-left: 200px; ">
                <div class="card-body">
                    <form>
                        <div class="modal-content">

                            <div class="modal-header">
                                <h5 class="modal-title">Enquiries</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <div class="form-group">
                                    <label style="color:black">From Date</label>
                                    <input id="fromdate3" type="date" class="form-control" style="border-radius: 10px;" />
                                </div>
                                <div class="form-group">
                                    <label style="color:black">To Date</label>
                                    <input id="todate3" type="date" class="form-control" style="border-radius: 10px;" />
                                </div>

                            </div>
                            <div class="modal-footer">
                                <button id="btnPrint3" type="button" class="btn btn-primary" style="border-radius:10px;">Print</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <!---->
    <!--popup for OpenEnquiries-->
    <div id="OpenEnquiriesModal" class="modal" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-lg" role="document">

            <div class="card" style="width: 350px; margin-left: 200px; ">
                <div class="card-body">
                    <form>
                        <div class="modal-content">

                            <div class="modal-header">
                                <h5 class="modal-title">Open Enquiries</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <div class="form-group">
                                    <label style="color:black">From Date</label>
                                    <input id="fromdate4" type="date" class="form-control" style="border-radius: 10px;" />
                                </div>
                                <div class="form-group">
                                    <label style="color:black">To Date</label>
                                    <input id="todate4" type="date" class="form-control" style="border-radius: 10px;" />
                                </div>
                                <div class="form-group">
                                    <label style="color:black">LE Name</label>
                                    <select id="lenames1" class="form-control" style="border-radius: 10px;" ></select>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button id="btnPrint4" type="button" class="btn btn-primary" style="border-radius:10px;">Print</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <!---->
    <!--popup for CancelledEnquiries-->
    <div id="CancelledEnquiriesModal" class="modal" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-lg" role="document">

            <div class="card" style="width: 350px; margin-left: 200px; ">
                <div class="card-body">
                    <form>
                        <div class="modal-content">

                            <div class="modal-header">
                                <h5 class="modal-title">Cancelled Enquiries</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <div class="form-group">
                                    <label style="color:black">From Date</label>
                                    <input id="fromdate5" type="date" class="form-control" style="border-radius: 10px;" />
                                </div>
                                <div class="form-group">
                                    <label style="color:black">To Date</label>
                                    <input id="todate5" type="date" class="form-control" style="border-radius: 10px;" />
                                </div>
                                <div class="form-group">
                                    <label style="color:black">LE Name</label>
                                    <select id="lenames2" class="form-control" style="border-radius: 10px;"></select>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button id="btnPrint5" type="button" class="btn btn-primary" style="border-radius:10px;">Print</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <!---->
    <!--popup for DriverLogs-->
    <div id="DriverLogsModal" class="modal" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-lg" role="document">

            <div class="card" style="width: 350px; margin-left: 200px; ">
                <div class="card-body">
                    <form>
                        <div class="modal-content">

                            <div class="modal-header">
                                <h5 class="modal-title">Driver Logs</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <div class="form-group">
                                    <label style="color:black">Driver Name</label>
                                    <select id="drivernames" class="form-control" style="border-radius: 10px;"></select>
                                </div>
                                <div class="form-group">
                                    <label style="color:black">Date</label>
                                    <input id="date1" type="date" class="form-control" style="border-radius: 10px;"/>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button id="btnPrint6" type="button" class="btn btn-primary" style="border-radius:10px;">Print</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <!---->
    <!--popup for SourceProgress-->
    <div id="SourceProgressModal" class="modal" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-lg" role="document">

            <div class="card" style="width: 350px; margin-left: 200px; ">
                <div class="card-body">
                    <form>
                        <div class="modal-content">

                            <div class="modal-header">
                                <h5 class="modal-title">Source Progress</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <div class="form-group">
                                    <label style="color:black">Select the Source</label>
                                    <select id="source" class="form-control" style="border-radius: 10px;"></select>
                                </div>
                                <div id="divothersource" class="form-group">
                                    <label style="color:black">Other Source</label>
                                    <select id="othersource" class="form-control" style="border-radius: 10px;"></select>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button id="btnPrint7" type="button" class="btn btn-primary" style="border-radius:10px;">Print</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <!---->
</div>



<script>
    $(document).ready(function () {
        $('#Paidvalue').val('NO');
        $('#Expectedvalue').val('NO');
        $('#divothersource').hide();

        var permission = "@Context.Session.GetString("CurrentUserRole")";
        var userle = "@Context.Session.GetString("CurrentUsername")";

        $.ajax({
            type: "POST",
            url: "@Url.Action("LoadLeName","Common")",
            success: function (response) {
                $('#lenames1').html('');
                $('#lenames1').append('<option value="" hidden> --Select-- </option>');

                $('#lenames2').html('');
                $('#lenames2').append('<option value="" hidden> --Select-- </option>');
                $.each(response, function (k, v) {
                    if (permission != "Administrator") {
                        // if (userle == v) {
                        //     $('#lenames').append('<option selected value="' + v + '" > ' + v + '</option>');
                        //     $('#lenames').prop('disabled', true);
                        // }
                        $('#lenames1').append('<option selected value="' + userle + '" > ' + userle + '</option>');
                        $('#lenames1').prop('disabled', true);

                        $('#lenames2').append('<option selected value="' + userle + '" > ' + userle + '</option>');
                        $('#lenames2').prop('disabled', true);
                    }
                    else {
                        $('#lenames1').append('<option value="' + v + '" > ' + v + '</option>');

                        $('#lenames2').append('<option value="' + v + '" > ' + v + '</option>');
                    }
                });
            }
        })

        $.ajax({
            type: "POST",
            url: "@Url.Action("LoadDriver","Common")",
            success: function (response) {
                $('#drivernames').html('');
                $('#drivernames').append('<option value="" hidden> --Select-- </option>');
                
                $.each(response, function (k, v) {
                    $('#drivernames').append('<option value="' + v + '" > ' + v + '</option>');
                });
            }
        })

        $.ajax({
            type: "POST",
            url: "@Url.Action("SourceProgressLoadSource","Common")",
            success: function (response) {
                $('#source').html('');
                $('#source').append('<option value="" hidden> --Select-- </option>');

                $.each(response, function (k, v) {
                    $('#source').append('<option value="' + v + '" > ' + v + '</option>');
                });
            }
        })

        $.ajax({
            type: "POST",
            url: "@Url.Action("SourceProgressLoadOtherSource","Common")",
            success: function (response) {
                $('#othersource').html('');
                $('#othersource').append('<option value="" hidden> --Select-- </option>');

                $.each(response, function (k, v) {
                    $('#othersource').append('<option value="' + v + '" > ' + v + '</option>');
                });
            }
        })

        $('#source').click(function () {
            var source = $('#source :selected').val();
            if (source == "Other") {
                $('#divothersource').show();
            }
            else {
                $('#divothersource').hide();
            }
        })

        $('#btnPaid').click(function () {
            $('#Paidvalue').val('YES');
            $('#Expectedvalue').val('NO');
            // var pvalue = $('#Paidvalue').val();
            // console.log(pvalue);
        })

        $('#btnExpected').click(function () {
            $('#Paidvalue').val('NO');
            $('#Expectedvalue').val('YES');
        })

        $('#btnPrint1').click(function () {
            var paid = $('#Paidvalue').val();
            var expected = $('#Expectedvalue').val();
            var fromdate = $('#fromdate1').val();
            var todate = $('#todate1').val();

            if(fromdate.length < 1){
                alert("Enter the From Date");
                return false;
            }

            if (todate.length < 1) {
                alert("Enter the To Date");
                return false;
            }

            if (paid == "NO" && expected == "NO") {
                alert("Which Report you want to generate? Paid or Expected?");
                return false;
            }

            if (paid == "YES"){
                window.location.href = '/Marketing/LOImonthlyrptpaid?fromdate=' + fromdate + '&todate=' + todate;
            }

            if (expected == "YES") {
                window.location.href = '/Marketing/LOImonthlyrpt?fromdate=' + fromdate + '&todate=' + todate;
            }
            
        })

        $('#btnPrint2').click(function () {
            var fromdate = $('#fromdate2').val();
            var todate = $('#todate2').val();

            if (fromdate.length < 1) {
                alert("Enter the From Date");
                return false;
            }

            if (todate.length < 1) {
                alert("Enter the To Date");
                return false;
            }

            $.ajax({
                type:"POST",
                url: "@Url.Action("GetPglCglCountMonthlyReport","Marketing")",
                data: { oldlcno: lcno, newlcno: newlcno },
                success: function (response) {
                    console.log(response);
                    alert("in process");
                }
            })

            //window.location.href = '/Marketing/LOImonthlyrptpaid?fromdate=' + fromdate + '&todate=' + todate;
            
        })

        $('#btnPrint3').click(function () {
            var fromdate = $('#fromdate3').val();
            var todate = $('#todate3').val();

            if (fromdate.length < 1) {
                alert("Enter the From Date");
                return false;
            }

            if (todate.length < 1) {
                alert("Enter the To Date");
                return false;
            }
            
            if (permission == "Administrator" && userle == "Admin") {
                window.location.href = '/Marketing/AllQueriesOnly?fromdate=' + fromdate + '&todate=' + todate;
            }
            else{
                alert("Access Denied");
            }
        })

        $('#btnPrint4').click(function () {
            var fromdate = $('#fromdate4').val();
            var todate = $('#todate4').val();
            var lenames = $('#lenames1 :selected').val();

            if (fromdate.length < 1) {
                alert("Enter the From Date");
                return false;
            }

            if (todate.length < 1) {
                alert("Enter the To Date");
                return false;
            }
            
            if (lenames) {
                window.location.href = '/Marketing/OpenQueries?fromdate=' + fromdate + '&todate=' + todate + '&lename=' + lenames;
            }
            else {
                window.location.href = '/Marketing/OpenQueriesnole?fromdate=' + fromdate + '&todate=' + todate;
            }
        })

        $('#btnPrint5').click(function () {
            var fromdate = $('#fromdate5').val();
            var todate = $('#todate5').val();
            var lenames = $('#lenames2 :selected').val();

            if (fromdate.length < 1) {
                alert("Enter the From Date");
                return false;
            }

            if (todate.length < 1) {
                alert("Enter the To Date");
                return false;
            }

            if (lenames) {
                window.location.href = '/Marketing/CancellQueries?fromdate=' + fromdate + '&todate=' + todate + '&lename=' + lenames;
            }
            else {
                window.location.href = '/Marketing/CancellQueriesnole?fromdate=' + fromdate + '&todate=' + todate;
            }
        })

        $('#btnPrint6').click(function () {
            var fromdate = $('#date1').val();
            
            var drivername = $('#drivernames :selected').val();

            if (fromdate.length < 1) {
                alert("Enter the Date");
                return false;
            }
            
            window.location.href = '/Marketing/Dlogs?fromdate=' + fromdate + '&drivername=' + drivername;
        })

        $('#btnPrint7').click(function () {
            var source = $('#source :selected').val();
            var othersource = $('#othersource :selected').val();

            if (source==null)
            {
                alert("Select Source");
                return false;
            }

            if (source == "Other") {

                if (othersource == null) {
                    alert("Select Other Source");
                    return false;
                }
                window.location.href = '/Marketing/SourceProcessOther?othersource=' + othersource;
            }
            else{
                window.location.href = '/Marketing/SourceProcess?source=' + source;
            }
        })
    })
</script>